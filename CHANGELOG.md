# Changelog

## 1.5.6
- Added: 新增"收藏条目"功能，支持跨预设收藏常用条目，并通过收藏面板快速转移到任意预设。
- Added: 新增 Changelog 自动生成工具（`npm run changelog`），可对比预设自动生成版本更新日志草稿。
- Added: 预设条目分组新增一键开关按钮，可快速启用/禁用分组内所有条目（类似正则分组的批量开关功能）。
- Added: 转移界面支持显示预设条目分组，可通过分组复选框一键选中整个分组进行转移。
- Added: 新增预设列表分组功能（使用 select2 库，无搜索功能），支持对预设下拉列表进行分组管理，分组状态跨设备同步。
- Fixed: 修复转移操作中的异步时序问题，避免界面刷新不及时。
- Fixed: 修复某些条目在插件中不显示的问题。

## 1.5.5
- Added: 恢复预设比较功能中的"覆盖左侧"和"覆盖右侧"按钮，支持快速用一侧条目覆盖另一侧同名条目。
- Added: 新增快照管理功能，支持查看、删除快照，并提供快照数据迁移工具。
- Added: 新增"UI主题分组"功能，支持对用户设置中的主题下拉框进行分组管理、拖拽排序，分组状态跨设备同步。
- Changed: 快照数据存储从 localStorage 迁移到 IndexedDB，提升存储容量和性能。
- Changed: 优化快照存储逻辑，改进数据持久化机制。
- Fixed: 修复功能勾选记忆问题(还是不确定有没有修好)。

## 1.5.4
- Added: 正则分组头部新增启用计数显示（格式：`(启用数/总数)`），实时反映分组内正则的启用状态。
- Added: 世界书条目批量编辑功能。
- Changed: 优化正则分组性能，切换分组内正则的启用/禁用开关时，分组头部计数自动更新，无需重新渲染整个列表。
- Changed: 优化世界书转移性能。

## 1.5.3
- Added: 新增"预设更新"功能，支持通过 Git 源配置实现预设版本切换、回退与更新日志查看。
- Added: 新增预设自动迁移缝合功能，导入新版本预设时可自动迁移旧版本的自定义条目（支持本地导入与 Git 更新）。
- Added: 新增"作者发布"功能，支持一键上传预设到 GitHub 并自动生成 Release 与 Changelog。
- Changed: 重构"转移工具"设置面板，拆分为"功能"、"预设更新"、"导出导入"三个标签页。
- Changed: 移动端转移工具设置面板标签按钮改为横向一行布局，提升操作便捷性。
- Changed: 预设正则绑定管理的显示优化。
- Changed: 预设条目状态保存逻辑优化，现在直接读取当前状态保存，不再依赖酒馆快照。
- Fixed: 修复功能开关默认值判断逻辑不一致导致更新后开关状态异常的问题。

## 1.5.2
- Added: 正则 Bulk Edit 模式新增“分组”按钮（SVG 图标），用于一键创建分组并弹出命名弹窗。
- Changed: 移除不稳定的正则分组三连击触发方式，改为按钮触发以提升兼容性。
- Changed: Bulk Edit 多选不连续时自动将所选正则移动为连续块（保持相对顺序），避免分组展开后被外部条目打散。
- Changed: 创建分组后自动清空 Bulk Edit 勾选状态。

## 1.5.1
- Fixed: 修复手机端世界书“选择以编辑”下拉框搜索框点击/触摸时事件穿透，导致误触发“点击外部自动关闭”的问题。

## 1.5.0
- Added: 新增“正则脚本分组”（可选开关），支持分组启用/禁用、默认折叠、并对齐酒馆原生正则面板的拖拽调序体验。正则导入拦截范围仅限本扩展导出的分组包（不影响酒馆原生/其他插件的正则导入）。

## 1.4.9
- Fixed: 对条目列表、对比弹窗、确认弹窗、预览警告、预设下拉等涉及用户可控文本的 HTML 渲染进行统一转义/净化加固（防 XSS 注入）。
- Fixed: 字体大小滑块可一致影响条目标题与关键弹窗操作按钮（含“编辑条目”底部按钮），并会同步应用到已打开的子弹窗。

## 1.4.8
- Added: 世界书条目编辑弹窗加入 AI 辅助（格式转换/辅助创作），仅作用于标题/内容（comment/content）。
- Changed: 世界书条目“触发策略”改为下拉框（关键词/常驻），常驻时禁用关键词输入与次关键词匹配逻辑。
- Changed: 预设更新界面移除“重新计算”与“保留旧版启用状态”，转移到目标预设的条目默认全部不启用。

## 1.4.7
- Fixed: 开启角色懒加载（`performance.lazyLoadCharacters`）时，世界书“已绑定/未绑定”分组误判与重启后丢失的问题（引入持久缓存并后台补全角色数据）。
- Fixed: 打开“世界书条目转移工具”时因同步加载世界书列表导致的卡顿（先渲染 UI，再异步填充下拉列表）。
- Changed: 超大条目列表渲染改为分帧分块，降低主线程阻塞。

## 1.4.6
- Changed: 世界书条目分组渲染逻辑优化。
- Changed: 世界书常用收藏按钮事件绑定改为随条目渲染，减少重复监听。
## 1.4.5
- Added: 预设包导出可选“同时导出全局世界书”，导入时支持一并导入并设置为全局世界书。
- Changed: “导入/导出预设正则包”文案精简为“导入/导出预设包”。
- Changed: 导入确认弹窗与“转移工具”开关的按钮/勾选框等样式跟随酒馆主题（颜色工具）。
- Changed: 移除“检测到冲突”标题中的 emoji。

## 1.4.4
- Added: 世界书常用（跨世界书收藏条目）与“世界书常用”面板，可在面板内对条目/分组/整本世界书进行启用/禁用。
- Added: 世界书编辑器条目列表注入收藏星标按钮，用于快速加入/移除“世界书常用”。
- Added: 输入框区域新增“世界书常用”快捷按钮，点击打开面板。

## 1.4.3
- Changed: 世界书分组（世界书列表手动分组）状态改为优先保存到 SillyTavern `extensionSettings`，同一实例跨浏览器同步（旧 localStorage 自动迁移）。
- Changed: 转移工具设置（功能开关）改为优先保存到 SillyTavern `extensionSettings`，同一实例跨浏览器同步（旧 localStorage 自动迁移）。

## 1.4.2
- Changed: 全选/不选仅作用于搜索/筛选后可见的条目。
- Fixed：修复检测同预设不同版本命名过于严格的问题。

## 1.4.1
- Added: 世界书条目分组（世界书编辑器条目列表三连击标记分组开始/结束，生成分组头并可折叠）
- Added: 转移工具设置新增开关“世界书条目分组”

## 1.4.0
- Added: 世界书分组（含世界书选择下拉框分组展示与批量管理分组/拖拽排序）。
- Added: 默认两组（已绑定/未绑定）按当前绑定状态自动归类；支持关闭其中一组后仅归类另一组。

## 1.3.3
- Changed: 移除预设正则仅 rerender 可见消息的旧刷新逻辑，避免与第三方渲染器事件链不一致。（改为走 `reloadCurrentChat()` 的原生刷新链路）。

## 1.3.2
- Fixed: 切换美化/主题后立即打开预设面板时，分组 UI 未及时跟随新渲染的问题（监听设置/主题变化并触发分组刷新）。

## 1.3.1
- Changed: 条目状态保存列表的“应用”按钮改为横向不换行布局，操作区更紧凑。
- Changed: 条目状态保存/分组功能的编辑与删除按钮统一改为 Font Awesome 图标（铅笔/垃圾桶），并统一按钮尺寸与对齐。

## 1.3.0
- Added: 扩展设置页新增“转移工具”折叠面板，集中管理功能开关与导入/导出预设正则包。
- Changed: 条目状态/预设正则的旧圆形开关移除，开关统一迁移到扩展设置面板；关闭后不再注入对应原生面板且不加载相关监听。
- Added: 条目分组支持关闭（关闭时断开观察器并清理已注入的分组 UI）。
- Changed: 导入/导出预设正则包按钮移动到“转移工具”面板顶部，布局更紧凑对齐。
- Added: 全局搜索：可跨预设/世界书搜索条目，并以“转移模式”插入到任意面板点击的条目后方。
- Changed: 世界书转移遵循世界书自身排序逻辑，全局搜索中点击“转移条目”后通过点击左/右面板区域选择目标世界书（无需选择插入位置）。
- Changed: 搜索选项改为齿轮弹窗（跨预设搜索 / 含内容（可能卡顿）），并记住用户选择（首次默认全不勾选）。

## 1.2.0
- Added: 新增“新建世界书条目”功能。
- Removed: 删除“世界书查看新增条目”功能。
- Fixed: 修复手机端世界书编辑界面“启用”开关布局异常（与当前条目区域对齐）。

## 1.1.3
- Maintenance: 发布版本用于验证更新提示与一键更新流程。

## 1.1.2
- Fixed: 一键更新请求补齐 CSRF Token，避免出现 “Forbidden”。

## 1.1.1
- Changed: 更新提示按钮改为云朵下载图标，提升辨识度。

## 1.1.0
- Added: 世界书（Worldbook）条目转移与编辑能力，统一到同一套操作体验中。
- Changed: 复制/移动等核心逻辑重构为 Adapter 架构，支持不同容器类型复用同一套流程。
- Added: 扩展更新推送（页面初始化检查一次），发现新版本时在字体按钮右侧提示并支持一键更新后自动刷新。

## 1.0.0
- Added: 初始版本。
